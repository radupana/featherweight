coverage:
  status:
    project:
      default:
        target: 70%
        threshold: 5%
    patch:
      default:
        target: 80%
        threshold: 10%

  precision: 2
  round: down
  range: "70...100"

comment:
  layout: "reach,diff,flags,files"
  behavior: default
  require_changes: true

ignore:
  # UI Layer - requires Compose testing framework
  - "app/src/main/java/com/github/radupana/featherweight/ui/screens/**"
  - "app/src/main/java/com/github/radupana/featherweight/ui/components/**"
  - "app/src/main/java/com/github/radupana/featherweight/ui/dialogs/**"
  - "app/src/main/java/com/github/radupana/featherweight/ui/theme/**"
  - "app/src/main/java/com/github/radupana/featherweight/ui/utils/**"

  # Dependency Injection - Hilt/Android runtime
  - "app/src/main/java/com/github/radupana/featherweight/di/**"

  # Android Activities - require Robolectric
  - "**/*Activity.kt"
  - "**/FeatherweightApplication.kt"

  # Firebase implementations - require Firebase SDK at runtime
  - "**/FirebaseAuthServiceImpl.kt"
  - "**/FirestoreRepository.kt"
  - "**/RemoteConfigService.kt"
  - "**/CloudFunctionService.kt"
  - "**/AccountDeletionService.kt"

  # Android Workers - require WorkManager/Android context
  - "**/worker/**"
  - "**/sync/worker/**"

  # Android system services - require Robolectric
  - "**/AudioRecordingService.kt"
  - "**/RestTimerNotificationService.kt"
  - "**/NotificationProvider.kt"
  - "**/VoiceTranscriptionService.kt"

  # ViewModels with Application context - require Robolectric or AndroidX test
  - "**/VoiceInputViewModel.kt"
  - "**/SyncViewModel.kt"

  # Utilities requiring Android context
  - "**/CloudLogger.kt"
  - "**/InstallationIdProvider.kt"
  - "**/ExportHandler.kt"
  - "**/MigrationStateManager.kt"
  - "**/WeightUnitManagerImpl.kt"
  - "**/AuthenticationManagerImpl.kt"

  # Build artifacts
  - "**/build/**"
  - "**/generated/**"

flags:
  viewmodel:
    paths:
      - app/src/main/java/com/github/radupana/featherweight/viewmodel/
  service:
    paths:
      - app/src/main/java/com/github/radupana/featherweight/service/
  repository:
    paths:
      - app/src/main/java/com/github/radupana/featherweight/repository/
  database:
    paths:
      - app/src/main/java/com/github/radupana/featherweight/data/
  cloud-functions:
    paths:
      - functions/src/
